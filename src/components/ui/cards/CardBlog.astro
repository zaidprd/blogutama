---
// src/components/ui/cards/CardBlog.astro

// Catatan: Impor ini sudah disesuaikan untuk Sanity
import AvatarBlog from "@components/ui/avatars/AvatarBlog.astro";
import { formatDate } from "@utils/utils";
import type { SanityPost } from "@lib/sanity"; 

// Mengganti CollectionEntry<"blog"> dengan SanityPost
interface Props {
  post: SanityPost; // Ganti blogEntry menjadi post
  blogLocale?: string;
}

const { post, blogLocale = "" } = Astro.props;

// Definisikan variabel URL dan Gambar menggunakan properti Sanity
const url = `/blog/${post.slug}`;
const imageSrc = post.cardImage || post.imageUrl || ''; 
const imageAlt = post.cardImageAlt || post.imageAlt || post.title;

// Pencegahan error jika data kosong (untuk keamanan)
if (!post || !post.slug) {
    return null;
}
---

<a
  class="group relative block rounded-xl outline-hidden ring-zinc-500 transition duration-500 focus-visible:ring-3 dark:ring-zinc-200 dark:focus:outline-hidden shadow-lg"
  href={url}
  data-astro-prefetch
>
    {/* 1. CONTAINER GAMBAR (Vertikal: TIDAK ADA ABSOLUTE) */}
    {/* Mengganti Image dengan tag <img> karena imageSrc sudah berupa URL Sanity */}
    <div
      class="relative overflow-hidden rounded-xl pt-[50%] md:pt-[60%]"
    >
        {imageSrc && (
          <img
            class="absolute start-0 top-0 size-full object-cover transition duration-500 group-hover:scale-110"
            src={imageSrc}
            alt={imageAlt}
            draggable={"false"}
            loading={"lazy"}
            width={800} 
            height={400} 
          />
        )}
    </div>

    {/* 2. CONTAINER KONTEN TEKS (Vertikal: DI BAWAH GAMBAR) */}
    <div class="mt-4 p-4">
        {/* Info Penulis/Tanggal (Avatar) */}
        <div class="flex items-center mb-3">
            {/* Mengganti blogEntry={blogEntry} menjadi post={post} */}
            <AvatarBlog post={post} /> 
            <div class="ms-3">
              <h4 class="font-bold text-neutral-800 dark:text-neutral-200">
                  {post.authorName} 
              </h4>
              <p class="text-xs text-neutral-500 dark:text-neutral-400">
                  {formatDate(new Date(post.pubDate))}
              </p>
            </div>
        </div>

        {/* Judul Post */}
        <h3
          class="text-balance text-xl font-bold text-neutral-800 group-hover:text-primary-600 dark:text-neutral-200 dark:group-hover:text-primary-500"
        >
                {post.title}
        </h3>
        
        {/* Kutipan / Excerpt */}
        <p class="mt-2 text-pretty text-neutral-600 dark:text-neutral-400">
                {post.excerpt}
        </p>
    </div>
</a>